<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>sufa</title>
    <style>
       iput,span{background: red}

        :indeterminate,:indeterminate+label{
            background: lime;
        }
    </style>
</head>
<body>
    <div class="content bifd cfgh">
        gasfssd
        <ul id="myLink">
            <li class="li-1">btn1</li>
            <li class="li-2">btn2</li>
            <li class="li-3">btn3</li>
        </ul>
        <input type="checkbox" id="checkbox">
        <div>
            <span>12342</span>
            <p>5232</p>
        </div>
        <label for="checkbox">background</label>

        <div draggable="true">可拖动</div>
    </div>
</body>


<script>
    // var inputs=document.getElementById('checkbox');
    // inputs.indeterminate=true;

    //回文
    //const sucai="qqqwwweeewwwqqq";
    // function checkPalindom(str){
    //     return str == str.split('').reverse().join('');
    // }
    // const real=checkPalindom(sucai);
    // console.log(real);

    //去掉重复值(1,indexof确认。2：object的key值确认)
    // let unique=[1,2,13,24,25,2,11,14,1,2,11];
    //
    // getUnique=(str)=>{
    //     let data=[];
    //     let obj={}
   //     for (let i=0,l=str.length;i<l;i++){-->
    //         // if(data.indexOf(str[i]) == -1){
    //         //     data.push(str[i]);
    //         // }
    //         if(!obj[str[i]]){
    //             obj[str[i]]=true;
    //             data.push(str[i]);
    //         }
    //     }
    //     return data;
    // }
    //     const real=getUnique(unique);
    //     console.log(real);

    // 计算重复最多的元素和次数
    // function getmaxstr(str){
    //     if(str.length == 0){
    //         return str;
    //     }
    //     var newarr=[];
    //     for(let i=0,l=str.length;i<l;i++){-->
    //         if(!newarr[str.charAt(i)]){
    //             newarr[str.charAt(i)] = 1;
    //         }else{
    //             newarr[str.charAt(i)] +=1;
    //         }
    //     }
    //     console.log(newarr);

    // var maxkey='';
    // var maxValue=1;
    // for(var k in newarr){
    //     if (newarr[k]>maxValue){
    //         maxValue=newarr[k];
    //         maxkey=k;
    //     }
    // }
    // console.log(maxkey,maxValue);
    // return (maxkey+"*"+maxValue);
    //}
    // var strs="assfdsghjsddggedfsvgh";
    // var strr=["1","a","s","a","d","f","s","7","fg"];
    // console.log(getmaxstr(strr));

    //快排
    // function quickSort(arr){
    //     if(arr.length<1){
    //         return arr;
    //     }
    //
    //     let leftArr=[];
    //     let rightArr=[];
    //     let q = arr[0];
    <!--for(let i = 1,l=arr.length;i<l;i++){}-->
    //         if(arr[i]>q){
    //             rightArr.push(arr[i])
    //         }else{
    //             leftArr.push(arr[i]);
    //         }
    //     }
    //     console.log(leftArr,[q],rightArr)
    //    return [].concat(quickSort(leftArr),[q],quickSort(rightArr));
    //     //只拼接了[q]
    // }
    // var sort=[8,3,5,2,10,1,12,16,4,7,15];
    // console.log(quickSort(sort));

    //判断最大差值
    //    const arr=[9,3,1,4,5,8,12];
    //
    //    function findMax(arr){
    //        var minValue=arr[0];
    //        var maxVal=0;
    //
    //        for(let i in arr){
    //            const realMin=arr[i]
    //            minValue=Math.min(minValue,realMin);
    //            const realMax=realMin-minValue;
    //            maxVal=Math.max(realMax,maxVal);
    //        }
    //     return maxVal;
    //    }
    // console.log(findMax(arr))

    //最大公约数
    // function greatestCommonDivisor(a,b){
    //     var num=0;
    //     while(b!=0){
    //         num=a%b;
    //         a=b;
    //         b=num;
    //     }
    //     return a;
    // }
    //
    // let s=greatestCommonDivisor(8,12)
    // console.log(s);

    // function treeObj(obj) {
    // obj.map(item => {
    //     if (item.parent !== null) {
    //         obj.map(o => {
    //             if (item.parent === o.id) {
    //                 if (!o.child) {
    //                     o.child = [];
    //                 }
    //                 o.child.push(item);
    //                 o.child = o.child;
    //             }
    //         });
    //     }
    // });
    // return obj.filter(item => item.parent === null)[0]

    //根据对应关系，生成树
    //     obj.map(item=>{
    //         if(item.parent !== null){
    //             obj.map(o =>{
    //                 if(item.parent === o.id){
    //                     if(!o.child){
    //                         o.child=[];
    //                     }
    //                     o.child.push(item);
    //                     o.child=o.child;
    //                 }
    //             });
    //         }
    //     });
    //     console.log(obj);
    //      return obj.filter(item =>item.parent === null)[0];
    // }
    //
    // var obj = [
    //     { id:5, parent:2},
    //     { id:4, parent:3 },
    //     { id:3, parent:1 },
    //     { id:1, parent:null },
    //     { id:2, parent:1 },
    // ]
    //
    // console.log(treeObj(obj));

    // function fun(n, o) {
    //     console.log(o);
    //     return {
    //         fun: function(m) {
    //             return fun(m, n);
    //         }
    //     }
    // }
    //第一次执行后生成fun回到函数，而之前作为回调函数的变量被保存
    //闭包能够将变量保存到内存中
    // fun(0) //显示undefined，n=0,生成fun回调函数
    // fun(0).fun(1)//fun(m=1)==>return fun(m=1,n=0)=>n=m=1,o=0==>生成fun（m）,此时n=1;



    // var str="this is a pen";
    //
    // function accum(str){
    //     let newstr=str.split(" ").map((v,i)=>{
    //             return v.substr(0).toUpperCase()
    //     })
    //     return newstr
    // }
    // console.log(accum(str));
    //
    //
    // //重新sort
    // var arrS=[2,6,12,53,42,0,5,26,23,7,1,4,75];
    //
    // function swap(arr,index1,index2){
    //     var step=arr[index1];
    //     arr[index1]=arr[index2];
    //     arr[index2]=step;
    // }
    //
    // //选择排序，(按顺序循环，每次找到最小的（更改后继续比较直到找到最小的），然后进行换位)
    // function chooseSort(arr){
    //     for (let i=0;i<arr.length;i++){
    //         let minIndex=i;
    //         console.log("初始值"+minIndex+"--"+arr[minIndex])
    //
    //         for (let j=i;j<arr.length;j++){
    //             if (arr[minIndex]>arr[j]){
    //                 minIndex=j;
    //                 console.log("找到"+j+"---"+arr[j]);
    //             }
    //         }
    //
    //         if (i !== minIndex){
    //             swap(arr,i,minIndex);
    //             console.log(minIndex+"循环"+i)
    //         }
    //     }
    // }
    //
    //
    //
    // chooseSort(arrS);
    // console.log(arrS);

    //变量提升，函数声明（函数提升最先）
    // var scope = 'global';
    // function f(){
    //     console.log(scope);
    //     var scope = 'local';
    //     console.log(scope);
    // }
    // f();

    // var f = function(){console.log(1)}
    //
    // function f(){console.log(2)}
    //
    // f();

    //工厂模式
    // function parent(name,age){
    //     var o=new Object();
    //     o.name=name;
    //     o.age=age;
    //     o.sayName=function () {
    //         console.log(this.name);
    //     }
    //     return o;
    // }
    // var person=new parent("name","age");
    // console.log(person);
    //
    //
    // //通过闭包封装变量的可读性，使用私有变量可以实现实例的私有化
    // function MyObject(){
    //     //私有变量和私有函数
    //     var privateVariable = 10;
    //     // function privateFunction(){
    //     //     return false;
    //     // }
    //     //特权方法
    //     this.publicMethod = function (){
    //         privateVariable++;
    //         // return privateFunction();
    //         return privateVariable;
    //     };
    // }
    // var public=new MyObject();
    // console.log(public.publicMethod())
    // console.log(public.publicMethod())
    //
    // var public1=new MyObject();
    // console.log(public1.publicMethod())
    // console.log(public1.publicMethod())

    // var arr=[{
    //     id:"1",
    //     name:"1",
    //     children:[
    //         {
    //             id:"1-1",
    //             name:"1-1",
    //             children:[ {
    //                 id:"1-1-1",
    //                 name:"1-1-1",
    //                 children:[]
    //             },
    //                 {
    //                     id:"1-1-2",
    //                     name:"1-1-2",
    //                     children:[]
    //                 }]
    //         },
    //         {
    //             id:"1-2",
    //             name:"1-2",
    //             children:[
    //                 {
    //                 id:"1-2-1",
    //                 name:"1-2-1",
    //                 children:[]
    //                 },
    //                 {
    //                 id:"1-2-2",
    //                 name:"1-2-2",
    //                 children:[]
    //                 }
    //             ]
    //         }
    //     ]
    // },{
    //     id:"2",
    //     name:"2",
    //     children:[
    //         {
    //             id:"2-1",
    //             name:"2-1",
    //             children:[{
    //                 id:"2-1-1",
    //                 name:"2-1-1",
    //                 children:[]
    //             },{
    //                 id:"2-1-2",
    //                 name:"2-1-2",
    //                 children:[]
    //             }]
    //         },
    //         {
    //             id:"2-2",
    //             name:"2-2",
    //             children:[{
    //                 id:"2-2-1",
    //                 name:"2-2-1",
    //                 children:[]
    //             },{
    //                 id:"2-2-2",
    //                 name:"2-2-2",
    //                 children:[]
    //             }]
    //         }
    //     ]
    // }]
    //
    // var mark="1-1-1"
    // function filter(menuDara,parent){
    //       let res=menuDara.filter(menu=>{
    //           console.log("num",menu.id)
    //         if(menu.children&&menu.children.length>0){
    //             let response=filter(menu.children,menu);
    //             if (response){
    //                 console.log("@@",response);
    //                 return true;
    //             }
    //         }
    //         var num=menu.name.toString().indexOf(mark) >= 0;
    //         return num;
    //     })
    //
    //    if(res.length >0 && parent){
    //        console.log("res",res)
    //        console.log("获取父级",parent.id);
    //        return true;
    //    }else{
    //        console.log("失败",res)
    //        return false;
    //    }
    // }
    //
    // filter(arr);

    // var someNode=document.querySelector("div")
    // var nodeArr=[...someNode.children]||Array.prototype.slice.call(someNode.children,0);
    //
    // console.log(nodeArr);
    //
    // nodeArr.forEach(node=>{
    //     if (node.nodeType == "1"){
    //         console.log("2345");
    //     }
    // })

    // var className=document.querySelector("div").className.split(' ');
    //
    //
    // var  pos=-1,i,len;
    //
    // for (i=0,len=className.length;i<len;i++){
    //     if (className[i] == 'bifd'){
    //         pos = i;
    //         break;
    //     }
    // }
    //
    // className.splice(i,1);
    // console.log(className.join(" "))

    //事件处理插件
    var EventUtil={
        addHandler:function (element,type,handler) {
            if (element.addEventListener){
                element.addEventListener(type,handler,false);
            }else  if(element.attachEvent){
                element.attachEvent("on"+type,handler);
            } else {
                element["on"+type]=handler;
            }
        },
        removeHandler:function (element,type,handler) {
            if (element.removeEventListener){
                element.removeEventListener(type,handler,false);
            }else  if (element.detachEvent){
                element.detachEvent("on"+type,handler);
            } else {
                element["on"+type]=null;
            }
        },
        getEvent:function (event) {
            return event?event:window.event;
        },
        getTarget:function (event) {
            return event.target || event.srcElement;
        },
        preventDefault:function (event) {
            if (event.preventDefault){
                event.preventDefault();
            } else{
                event.returnValue=false;
            }
        },
        stopPropagation:function (event) {
            if (event.stopPropagation){
                event.stopPropagation();
            }else{
                event.cancelBubble=false;
            }
        }
    }


    //事件委托
    var liArr=document.getElementById("myLink");

    EventUtil.addHandler(liArr,"click",function (event) {
        event=EventUtil.getEvent(event);
        var target=EventUtil.getTarget(event);
            console.log(target.textContent);
    })

    //构建一个深拷贝的函数

    init=((e)=>{
        console.log(e);
    })


    class EventEmeitter{
        constructor(){
            this._events =this._events || new Map();
            this._maxListeners = this._maxListeners||10;
        }
    }

    EventEmeitter.prototype.emit=function(type,...args){
       let handler;
       handler = this._events.get(type);
       if (Array.isArray(handler)) {
           for (let i = 0, l = handler.length; i < l; i++) {
               if (args.length > 0) {
                   handler[i].apply(this, args);
               } else {
                   handler[i].call(this);
               }
           }
       }
       else
           {
               if (args.length>0){
                   handler.apply(this,args);
               } else{
                   handler.call(this);
               }

           }
       return true;
    }

    EventEmeitter.prototype.addListener=function(type,fn){
        const handler=this._events.get(type);
        if (!handler){
            this._events.set(type,fn);
        } else if (handler&& typeof handler === 'function'){
            this._events.set(type,[handler,fn]);
        } else{
            handler.push(fn);
        }
    }

    const emitter=new EventEmeitter();

    emitter.addListener('arson',man=>{
        console.log(`expel ${man}`);
    });
    emitter.addListener('arson',man=>{
        console.log(`expel1 ${man}`);
    });

    emitter.addListener('arson', man => {
        console.log(`kill ${man}`);
    });



    emitter.emit('arson','low-end');


    //28个技巧
    // 1.生成指定空间内的随机数
    // (Math.random()*(max-min)+min).toFixed(0);
    //2.列表聚合
    // list.reduce((old,ss)=>old*1+ss*1,0)//预防出现字符串，但只能在数组中使用，对象的话只能使用便利
    //３.使用字典

    function Dictionary() {
        this.dataStore=[];
        this.add=add;
        this.find=find;
        this.remove=remove;
        this.count=count;
        this.showAll=showAll;
        this.clear=clear;

        function add(key,val) {
            this.dataStore[key]=val;
        }

        function find(key){
            return this.dataStore[key];
        }

        function remove(key){
            if (this.dataStore[key]) delete this.dataStore[key];
            else return "not found"
        }

        function showAll(){
            var sortKeys = Object.keys(this.dataStore).sort();
            for( var key in sortKeys ){
                console.log( sortKeys[key] + '->' + this.dataStore[sortKeys[key]] );
            }
        }

        function count() {
            // return this.dataStore.length;//这个方法在键为字符串的时候不起作用
            var n=0;
            for (let i in this.dataStore){
                ++n
            }
            return n;
        }

        function clear(){
            for( var key in this.dataStore ){
                delete this.dataStore[key];
            }
        }
    }

    var directory=new Dictionary();

    //添加元素
    directory.add( 'Jack' , '138****5505' );
    directory.add( 'Alice' , '156****6606');
    directory.add( 'Tom' , '180****8808');

    console.log("字典开始")
    directory.showAll();

    console.log("删除操作")
    directory.remove('Tom');
    directory.showAll();


    //活用pop和ｐｕｓｈ来进行数据的有顺序增删操作

    //用零补全位数
    console.log(prefixInteger(3677.8))

    function prefixInteger(num,) {
        return (num / Math.pow(10, 2)).toFixed(2);
    }

    //url和科技
    var urls='?wd=蔡徐坤&skill=篮球&year=2019';
    console.log(location.hostname);
    console.log(location.port);
    var searchUrl=new URLSearchParams(urls);//获得参数部分
    console.log(searchUrl.get('wd'));//获取字段
    searchUrl.append('sss','234');
    console.log(searchUrl.get('sss'));

    //Es5－－实现ｍａｐ
    Array.prototype.myMap =function(fn,context){
        let arr=Array.prototype.slice.call(this);
        console.log(fn+"%%%"+arr+"%%%"+context+"%%%%"+this);
        let mappedArr=[];
        for (let i=0;i<arr.length;i++){
            if (!arr.hasOwnProperty(i)) continue;
            mappedArr.push(fn.call(context,arr[i],i));
            //更改当前ｔｈｉｓ指向到全新的作用域，ａｒr[i]函数需要的值
        }
        return mappedArr;
    }

    let a=[1,2,3,4];
    let b=a.myMap(val=>val+1);
    b.myMap((obj,i)=>{
        console.log(obj,i);
    });

    //函数柯里化
</script>

</html>
